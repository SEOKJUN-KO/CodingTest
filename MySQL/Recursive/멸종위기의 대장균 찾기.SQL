WITH RECURSIVE TMP AS (
    SELECT
    ID,
    1 AS G
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL
    
    UNION ALL
    
    SELECT
    E.ID,
    T.G + 1 AS G
    FROM ECOLI_DATA E
    JOIN TMP T ON T.ID = E.PARENT_ID
    
)

SELECT 
COUNT(*) AS COUNT, 
G AS GENERATION
FROM TMP
WHERE ID NOT IN (
    SELECT DISTINCT PARENT_ID AS ID
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NOT NULL
)
GROUP BY G
ORDER BY G