WITH MAXFISH AS (
    SELECT
    FISH_TYPE,
    MAX(LENGTH) AS LENGTH
    FROM FISH_INFO
    GROUP BY FISH_TYPE
    HAVING MAX(LENGTH)
)
, GETNAME AS (
    SELECT 
    FISH_TYPE,
    LENGTH,
    (
        SELECT FISH_NAME
        FROM FISH_NAME_INFO FNI
        WHERE MF.FISH_TYPE = FNI.FISH_TYPE
    ) AS FISH_NAME
    FROM MAXFISH MF
)

SELECT
ID,
FISH_NAME,
GN.LENGTH
FROM GETNAME GN
JOIN FISH_INFO FI 
ON GN.FISH_TYPE = FI.FISH_TYPE AND GN.LENGTH = FI.LENGTH
ORDER BY ID

